# Data Model: Installation and Walking Skeleton

**Phase 1 Output**: Entity definitions, relationships, and validation rules for the feature.

## Entities

### Coding Agent
- **Purpose**: Represents supported AI coding assistants
- **Fields**:
  - name: str (e.g., "claude", "codex-cli", "gemini", "qwen")
  - prompt_location: str (filesystem path for prompts)
  - command_syntax: str (slash command format)
  - file_extension: str (e.g., ".md", ".toml")
  - folder_structure: str (specific folder pattern for agent)
  - discontinued: bool (for fallback handling)
- **Validation**: Must be in supported list, path must exist if validated, file_extension must be supported format
- **Relationships**: Used by Script File (generates agent-specific scripts), Prompt File (determines location and format)
- **Agent-Specific Configurations**:
  - claude: .claude/commands/ with .md files
  - codex-cli: .codex/prompts/ with .md files
  - gemini: .gemini/commands/ with .toml files  
  - qwen: .qwen/commands/ with .toml files

### Operating System
- **Purpose**: Target platform for script generation
- **Fields**:
  - type: str ("macos/linux", "windows")
  - script_type: str ("bash", "powershell")
  - path_separator: str ("/" or "\")
- **Validation**: Must be supported OS type
- **Relationships**: Determines Script File type and syntax

### Temp Workspace
- **Purpose**: Root directory for generated files
- **Fields**:
  - path: str (absolute filesystem path)
  - subfolders: dict (maps folder names to purposes)
- **Validation**: Path must be writable, subfolders created if missing
- **Relationships**: Contains all generated Script Files, Prompt Files, Template Files

### Script File
- **Purpose**: Executable script for slash command logic
- **Fields**:
  - path: str (relative to temp workspace)
  - type: str ("bash" or "powershell")
  - content: str (generated script text)
  - permissions: str ("executable")
- **Validation**: Content matches template, executable on target OS
- **Relationships**: Generated by Script Generator, executed by Agent

### Prompt File
- **Purpose**: Agent-specific instruction file for slash commands
- **Fields**:
  - agent: str (reference to Coding Agent)
  - path: str (agent-specific location, includes file extension)
  - content: str (generated prompt text, formatted according to agent's file_extension)
  - format_type: str (markdown for claude/codex-cli, toml for gemini/qwen)
- **Validation**: Path matches agent config and extension, content matches required format for file_extension
- **Relationships**: Used by Agent for slash command execution
- **Agent-Specific Formats**:
  - claude: .md files in .claude/commands/
  - codex-cli: .md files in .codex/prompts/
  - gemini: .toml files in .gemini/commands/
  - qwen: .toml files in .qwen/commands/

### Template File
- **Purpose**: Reusable text templates for file generation
- **Fields**:
  - name: str (e.g., "hello-gmkit-template.md")
  - content: str (template with placeholders)
  - variables: list (required substitution keys)
  - format_type: str ("markdown" or "toml")
- **Validation**: All variables defined in generation process
- **Relationships**: Used by Script File to generate output files
- **Generation Strategy**:
  - Markdown templates (.md): Single source of truth for prompt content
  - TOML templates (.toml): Generated dynamically by embedding markdown content into TOML format
  - Template manager handles both direct copying and content embedding based on agent requirements
- **Validation Strategy**:
  - TOML file validation using Python built-in `tomllib` library
  - No external dependencies required for format verification
  - Clear error reporting with line/column information for debugging

### Greeting File
- **Purpose**: Sequenced output file from slash command
- **Fields**:
  - sequence_number: int (incremented from existing files)
  - path: str (greetings/ directory)
  - content: str (filled template)
  - timestamp: datetime (creation time)
- **Validation**: Sequence number unique, content matches template
- **Relationships**: Generated by Script File execution

## Relationships

- Temp Workspace contains Script Files, Prompt Files, Template Files
- Coding Agent determines Prompt File location and Script File agent-specific logic
- Operating System determines Script File type
- Script File uses Template File for content generation
- Script File creates Greeting Files with sequence numbers

## Validation Rules

- All paths must be absolute and platform-appropriate
- Sequence numbers must increment from highest existing
- Agent validation occurs before file generation
- Directory creation handled automatically for missing paths
- File permissions set correctly for executables